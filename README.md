<div align="center">

# üß¨ COVID-19 Patient Transcriptomics

**A comprehensive R-based analysis pipeline for exploring differential gene expression and pathway enrichment in COVID-19 patient transcriptomic data**

[![R](https://img.shields.io/badge/R-%3E%3D4.0-blue?logo=r&logoColor=white)](https://www.r-project.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Bioconductor](https://img.shields.io/badge/Bioconductor-clusterProfiler-blue)](https://bioconductor.org/)

---

</div>

## üìã Table of Contents

- [Overview](#-overview)
- [Repository Structure](#-repository-structure)
- [Prerequisites](#-prerequisites)
- [Quick Start](#-quick-start)
- [Data Sources](#-data-sources)
- [Outputs](#-outputs)
- [Citation](#-citation)

---

## üéØ Overview

This repository contains **R scripts and supporting data** for reproducing analyses of transcriptomic profiles from COVID-19 patients. The workflow:

- üìä Loads supplemental clinical and gene expression data from the associated publication
- üîÑ Processes and harmonizes tables
- üìà Generates publication-ready figures (volcano and dot plots)
- üß™ Illustrates differential gene expression (DGE) and pathway enrichment

---

## üìÅ Repository Structure

```
COVID-19-Patient-Transcriptomics/
‚îÇ
‚îú‚îÄ‚îÄ üìÇ CODE/                      # R scripts that implement the analysis pipeline
‚îÇ   ‚îú‚îÄ‚îÄ 01_data_prep.R            # Prepare clinical metadata, DGE results, and pathway annotations
‚îÇ   ‚îú‚îÄ‚îÄ 02_volcano_plot.R         # Build a volcano plot highlighting regulated genes
‚îÇ   ‚îî‚îÄ‚îÄ 03_dot_plot.R             # Summarize pathway-level changes in a dot plot
‚îÇ
‚îú‚îÄ‚îÄ üìÇ DATA/                       # Supplementary Excel workbooks with patient metadata and DGE tables
‚îÇ   ‚îú‚îÄ‚îÄ mmc2.xlsx                 # DGE results
‚îÇ   ‚îî‚îÄ‚îÄ mmc3.xlsx                 # Patient metadata
‚îÇ
‚îú‚îÄ‚îÄ üìÇ PLOTS/                      # Rendered figures saved as PDF files
‚îÇ   ‚îú‚îÄ‚îÄ volcano.pdf               # Volcano plot visualization
‚îÇ   ‚îî‚îÄ‚îÄ dot.pdf                   # Pathway enrichment dot plot
‚îÇ
‚îú‚îÄ‚îÄ üìÇ R/                          # Cached CSV exports generated by the scripts
‚îÇ   ‚îú‚îÄ‚îÄ DGE_results.csv           # Cleaned differential expression results
‚îÇ   ‚îî‚îÄ‚îÄ DGE_pathways.csv          # Gene-to-pathway mappings
‚îÇ
‚îú‚îÄ‚îÄ üìÑ project2_downloads.R         # Helper script for retrieving raw data
‚îî‚îÄ‚îÄ üìÑ Project2.Rproj              # RStudio project configuration
```

---

## üîß Prerequisites

The scripts expect an **R (‚â•4.0)** environment with the following packages:

| Package | Purpose | Source |
|---------|---------|--------|
| `readxl` | Excel file reading | CRAN |
| `clusterProfiler` | Pathway enrichment analysis | Bioconductor |
| `DOSE` | Disease ontology analysis | Bioconductor |
| `org.Hs.eg.db` | Human gene annotation database | Bioconductor |
| `ggplot2` | Data visualization | CRAN |
| `ggrepel` | Label positioning for plots | CRAN |
| `ggpubr` | Publication-ready plots | CRAN |

> üí° **Pro Tip:** `project2_downloads.R` automates the installation of CRAN and Bioconductor dependencies and downloads the required supplemental data files if they are not already present.

---

## üöÄ Quick Start

### Step 1: Setup
Open the project in RStudio (`Project2.Rproj`) or set the working directory to the repository root.

### Step 2: Data Preparation
Run `CODE/01_data_prep.R` to:
- ‚úÖ Import patient metadata (`DATA/mmc3.xlsx`) and DGE results (`DATA/mmc2.xlsx`)
- ‚úÖ Harmonize column names and severity labels
- ‚úÖ Join genes with GO annotations and KEGG pathways
- ‚úÖ Export intermediate CSV files to the `R/` directory

### Step 3: Generate Volcano Plot
Run `CODE/02_volcano_plot.R` to create the volcano plot highlighting up- and down-regulated genes.  
üìÑ Output: `PLOTS/volcano.pdf`

### Step 4: Generate Dot Plot
Run `CODE/03_dot_plot.R` to calculate pathway-level summaries and render the combined dot plot.  
üìÑ Output: `PLOTS/dot.pdf`

> ‚ö†Ô∏è **Note:** Each script assumes the working directory is the project root (`setwd("~/Project2")`). If you clone the repository to a different path, update or remove the `setwd` calls before running the code.

---

## üìä Data Sources

The `DATA/` folder stores the supplemental workbooks (`mmc2.xlsx`, `mmc3.xlsx`) referenced in the original publication. The analysis does not modify these files; derived tables are written to `R/`.

---

## üìà Outputs

| File | Description |
|------|-------------|
| `R/DGE_results.csv` | Cleaned differential expression results |
| `R/DGE_pathways.csv` | Mapping of differentially expressed genes to KEGG pathways |
| `PLOTS/volcano.pdf` | Volcano plot for the DGE comparison |
| `PLOTS/dot.pdf` | Dot plot summarizing pathway enrichment for up- and down-regulated genes |

---

## üìö Citation

If you use this repository, please cite the original study that produced the supplemental data and acknowledge this analysis pipeline.

---

<div align="center">

**Made with ‚ù§Ô∏è for COVID-19 research**

</div>
